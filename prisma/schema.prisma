generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model VehicleType {
  id            String        @id @default(cuid())
  name          String
  seats         Int
  luggageSmall  Int
  luggageMedium Int
  luggageLarge  Int
  isLuxury      Boolean       @default(false)
  isBus         Boolean       @default(false)
  description   String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  bookings      Booking[]
  pricing       PricingRule[]
}

model PricingRule {
  id            String      @id @default(cuid())
  fromArea      String
  toArea        String
  tripType      String
  basePriceJpy  Int
  nightFeeJpy   Int         @default(0)
  urgentFeeJpy  Int         @default(0)
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  vehicleTypeId String
  vehicleType   VehicleType @relation(fields: [vehicleTypeId], references: [id])

  @@index([fromArea, toArea, tripType, vehicleTypeId])
}

model Booking {
  id                         String      @id @default(cuid())
  createdAt                  DateTime    @default(now())
  updatedAt                  DateTime    @updatedAt
  status                     String      @default("PENDING_PAYMENT")
  isUrgent                   Boolean     @default(false)
  currency                   String      @default("JPY")
  tripType                   String
  pickupTime                 DateTime
  pickupLocation             String
  dropoffLocation            String
  flightNumber               String?
  flightDate                 DateTime?
  flightNote                 String?
  passengers                 Int
  childSeats                 Int         @default(0)
  luggageSmall               Int         @default(0)
  luggageMedium              Int         @default(0)
  luggageLarge               Int         @default(0)
  contactName                String
  contactPhone               String
  contactEmail               String
  contactNote                String?
  pricingBaseJpy             Int
  pricingNightJpy            Int         @default(0)
  pricingUrgentJpy           Int         @default(0)
  pricingChildSeatJpy        Int         @default(0)
  pricingManualAdjustmentJpy Int         @default(0)
  pricingTotalJpy            Int
  pricingNote                String?
  cancelReason               String?
  cancelledAt                DateTime?
  vehicleTypeId              String
  vehicleType                VehicleType @relation(fields: [vehicleTypeId], references: [id])
}
